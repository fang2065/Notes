cSTAR: cell state transition assessment and regulation (cSTAR)

https://www.nature.com/articles/s41586-022-05194-y

cSTAR is used to evaluate the cell state and molecular phenotypes under different perturbations (such cellular state is not mutually exclusive in a dynamic biological environment, e.g. epithelial/mesenchymal states; differentiation/proliferation; drug-resistant/sensitive states), as well as the kinetics of the core networks that contribute to the cell state transition (facilitate the interpretation/prediction of the biological events responsible for cell manoeuvring in Waddington’s landscape). 

Workflow (in my understanding): 
(1) The pre-processing and clustering of molecular dataspace (omics datasets such as scRNAseq). Identify a hyperplane that separates data points (samples) in different phenotypic state using support vector machines (SVMs) from a high dimensional space. 
(2) A state transition vector (STV) is constructed based on the distance between the two centroids of data points from distinct cellular states in the molecular dataspace. STV contains the information (from the omics datasets) about the core biological pathways that represents the cell state transitions (both the direction and strength). 
(3) Perturbation normally changes the cell state in the multidimensional dataspace, in which a perturbation vector can be calculated to represent the effect of perturbation on the cell state outcome. This perturbation vector can be further decomposed into a vector collinear with the STV (which contributes to the cell fate decision) and a vector perpendicular to the STV (which does not contribute to the cell fate decision). Here, a dynamic phenotype descriptor (DPD) was calculated to measure movement of the centroid of a point cloud (the perturbation group) relative to the separating hyperplane (“The DPD module output is the distance of a centroid from the separation hyperplane determined along or opposite the STV direction”). 
(4) To further investigate the important biological pathway in cell fate decision, Bayesian modular response analysis (BMRA) makes full use of few perturbations to reconstruct the topology of the molecular network with the connection strength and direction. While the nodes of core molecular network are deduced from the STV in the perturbation, a DPD node represents all the important pathways outside of the core network (so that DPD node is an essential step between the core network and the final cell fate decision) and its output in the multidimensional space is DPD in step 3. 
(5) As a final step, Ordinary differential equations (ODEs) or Stochastic Differential Equations (SDEs) was used to construct the mechanistic model, quantify the cost of cell state changes and indicate the key node in the biological network for potential intervention. 



DIISCO: A Bayesian framework for inferring dynamic intercellular interactions from time-series single-cell data. 

https://www.biorxiv.org/content/10.1101/2023.11.14.566956v1

DIISCO (Dynamic Intercellular Interactions in Single Cell transcriptomic) is a Bayesian framework that tracks the temporal changes of diverse cell populations and infers the dynamics of intercellular crosstalk from time-series scRNA-seq data.  
First, scRNAseq data from different time points is merged, pre-processed, clustered, and annotated to identify the different cell states/types across the time. The specified cell populations will be used for the following intercellular communication. At each available time point, DIISCO uses a generative process to sample a set of latent features, cell-cell interaction matrix and standardized cell type proportions via Gaussian process, in which the corresponding hyper-parameters will be critical for the quality of modelling. To limit the solution space of the prior distribution over the cell-cell interaction, a binary matrix is constructed to represent the interaction of each cell pair apriori, and exclude the insignificant cell-cell crosstalk, based on the differential expression of receptor-ligand pairs in both populations from the prior knowledge. A two-step approximate inference method is performed to obtain an approximation to the posterior distribution over latent features and the interaction matrix. 
Of note, the biological assumption in DIISCO modelling is that the cell-cell interaction should contribute to a significant change in the cell type composition over the time. 

SPLiT-seq/Parse 
(https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7643870/)
In SPLiT-seq, individual transcriptomes are uniquely labeled by passing a suspension of formaldehyde fixed cells or nuclei through four rounds of combinatorial barcoding. In the first round of barcoding, cells are distributed into a 96-well plate and cDNA is generated with an in-cell reverse transcription (RT) reaction using well-specific barcoded primers. Each well can contain a different biological sample – thereby enabling multiplexing of up to 96 samples in a single experiment. After this step, cells from all wells are pooled and redistributed into a new 96-well plate, where an in-cell ligation reaction appends a second well-specific barcode to the cDNA. The third-round barcode, which also contains a unique molecular identifier (UMI), is then appended with another round of pooling, splitting, and ligation. After three rounds of barcoding, the cells are pooled, split into sublibraries, and sequencing barcodes are introduced by PCR. This final step provides a fourth barcode, while also making it possible to sequence different numbers of cells in each sublibrary. After sequencing, each transcriptome is assembled by combining reads containing the same four-barcode combination (Fig. 1A, Fig. S1A).

A) Labeling transcriptomes with split-pool barcoding. In each split-pool round, fixed cells or nuclei are randomly distributed into wells and transcripts are labeled with well-specific barcodes. Barcoded RT primers are used in the first round. Second and third round barcodes are appended to cDNA through ligation. A fourth barcode is added to cDNA molecules by PCR during sequencing library preparation. The bottom scheme shows the final barcoded cDNA molecule. (B) Species mixing experiment with a library prepared from 1,758 whole cells. Human UBCs are blue, mouse UBCs are red, and mixed-species UBCs are gray. The estimated barcode collision rate is 0.2%, whereas species purity is >99%.



MultiNicheNet:a flexible framework for differential cell-cell communication analysis from multi-sample multi-condition single-cell transcriptomics data 
https://www.biorxiv.org/content/10.1101/2023.06.13.544751v1.full.pdf
NicheNet-v2: improved version of ligand-receptor network and ligand-target prior knowledge modelling database (Omnipath) 
MultiNicheNet: 
•	prioritizes both differentially active and expressed ligand-receptor pairs (to reduce the false positive rate) 
•	includes the sample-to-sample variation minimization and batch correction for multi-sample multi-condition scRNAseq databases 
•	then infer the active intercellular communication and subsequent downstream analysis between conditions of interest (e.g. multiplexed experimental design or integrated atlas data) 
Methods: 
1.	Pseudobulk aggregation for each cell type in each sample (pseudobulk sample pooling) and edgeR-based DE analysis for samples in different conditions
2.	Obtain normalized expression levels of the ligand and receptor in condition/cell-type-specific setting. 
3.	calculate up/downregulated genes in the receiver cell population to evaluate the NicheNet ligand activity score for each ligand in each cell type 
4.	filter the ligand-receptor pair based on previous calculated information:1) differential expression level of the ligand in the sender cell type; 2) differential expression level of the receptor in the receiver cell type; 3) ligand activity of the ligand in a receiver cell type in a specific condition contrast; 4) in the highlighted condition of interest, log-transformed normalized pseudobulk expression values of each ligand/receptor in sender/receiver population respectively; 5) the fraction of samples (per condition) with sufficient expression of both ligand and receptor in corresponding sender-receiver pair. 
5.	a final prioritization score is calculated by a weighted aggregation. 



EasySci-RNA and EasySci-ATAC 
https://www.nature.com/articles/s41588-023-01572-y 
A cost-effective single-cell transcriptomics and chromatin accessibility profiling (EasySci-RNA and EasySci-ATAC respectively) 
EasySci-RNA:
•	Cost: $700 per 1 million single-cell transcriptomes (10x cell hashing, 82k; SPLiT-seq, 10k; sci-RNA-seq3, 3.5k) 
•	The use of indexed oligo-dT and random hexamer primers in the reverse transcription facilitates the full gene coverage instead of 3/5-end enrichment. 
•	Increased cell recovery rate (capture efficiency) and the number of transcripts detected per cell after careful optimization of fixation and nucleus extraction.
•	Paired-end sequencing of cDNA enables gene and exonic counting. 
•	Advantageous for the rare cell population detection and multiplexed experimental design. 
How-EasySci-RNA: combinatorial indexing 
1.	Nuclei extraction/fixation/washing/counting 
2.	Reverse transcription: 20,000 nuclei per well of 2 96-well plates, generating one pair of cDNA strands by introducing indexed short-dT (3-end coverage) and randomN primers (full gene body coverage) respectively. 
3.	Sample pooling/redistribution 
4.	Indexed ligation with a new barcode 
5.	Second Sample pooling/redistribution 
6.	Second-Strand Synthesis/Ampure Beads Purification/Tagmentation 
7.	SDS treatment with indexed P7 primers (with the third barcode for paired cDNAs) 
8.	PCR and library purification



Memory-Seq and scMemorySeq 

Memory-Seq
https://www.cell.com/cell/fulltext/S0092-8674(20)30868-0?_returnURL=https%3A%2F%2Flinkinghub.elsevier.com%2Fretrieve%2Fpii%2FS0092867420308680%3Fshowall%3Dtrue


scMemorySeq 
https://www.nature.com/articles/s41467-023-41811-8

In general, cancer cells are either resistant or sensitive to drug therapy. Before the drug therapy, a rare population of cancer cells may be primed for therapy-tolerant persister with a heritable transcriptomic profile independent of genetic mutations. A specific expression pattern, defined as cellular memory, can be retained in this primed population over several cell divisions (5-10 passages, in terms of cell line) without any external stress (defined as pre-resistant cells), but will be strengthened upon the drug selection, resulting in an expansion of post-resistant cells. Please keep in mind that the primed state may not be as identical as the drug resistant phenotype after the treatment. It is possible that the molecular pathways in the primed state may be potentially sufficient for maintaining the percentage of primed state cells, but not necessary for the drug resistance mechanism. 

A cellular memory should only be repeatedly captured in one or several clones sharing similar molecular phenotypes (heritable expression). Different from the key modules in cellular memory, a transient fluctuation of gene expression (i.e. the transcriptomic noise irrelevant to the therapy susceptibility) should be randomly distributed across phenotypically distinct clones through cell divisions (non-heritable expression). This cellular memory on the transcriptomic level can be modelled into a reversible and dynamic process at a frequency of state-switching (as a kinetic parameter of ‘remembering’ and ‘forgetting’) over a prolonged timescale. However, due to the temporal consistence and lineage specificity, single-cell transcriptomic snapshot or bulk transcriptomic profiling of mixed clones cannot capture the cellular memory comprehensively and precisely. 

Memory Sequencing: 
Single cell sorting of 100 melanoma cells into 48 separate wells, in which cell proliferates into 100,000 cells for bulk RNAseq to obtain the gene expression profile in each MemorySeq clone. The expression of memory-related genes should be highly enriched in rare clones so the count distribution of high-memory genes should be marked with a high variability across all clones. The relationship between the coefficient of variation and the transcripts per million for every gene could be fit by a Poisson regression model, in which the heritable genes are selected with residuals in the top 2%. To exclude the expression variability from technical reasons, cDNA library from a mixed cell population without single-cell sorting was used as a noise control. 

scMemorySeq: 
A combination of scRNAseq and cellular barcoding to track the lineages of primed and drug-susceptible cells before and after therapeutic treatment. Cells were transduced with a barcode library with 100-bp semi-random sequence at 3-UTR of GFP. While 10x Genomics 3’ sequencing kits was used to generate a cDNA library, the barcode library was independently recovered from gDNA, followed by the integration of scRNA-seq with barcode data. As the information about lineage identity and cellular state is available for each cell, the transition of cellular state and underlying molecular switching modulators can be detected. At least four lineages can be expected from an experiment, two with consistent state (either sensitive or resistant) and two with state switching (sensitive-to-resistant or resistant-to-sensitive). 



LARRY
https://www.science.org/doi/10.1126/science.aaw3381#core-collateral-metrics


LIANA+: an all-in-one cell-cell communication framework 
https://www.biorxiv.org/content/10.1101/2023.08.19.553863v1
LIANA focuses on inferring the intercellular interaction and intracellular signalling using single-cell and spatially-resolved multi-omics data. 
In the samples at steady state, LIANA performs integration and aggregation of results from multiple ligand-receptor interaction predictions. The most ‘relevant’ interactions will be ordered based on the aggregated rank, which is calculated by combining outputs from cellchat, cellphoneDB and etc. 
While handling the samples from different conditions/treatments, it is worth noting that this kind of database 1) has a list of perturbed variables, which are normally interdependent, 2) needs to perform higher-order dimensionality reduction to extract the important features across the conditions and then perform the pairwise comparisons; 3) covariates such as samples and cell types need to be modelled together with the perturbed variables. Thus, two approaches are available in LIANA, supervised (hypothesis-driven) and non-supervised (hypothesis-free) approach.
In the supervised approach, the pseudobulk profiles are calculated for each cell type in the scRNAseq database, followed by the differentiated-expression analysis for different conditions, which are then aggregated into ligand-receptor statistics across cell type pairs. The integration of DE genes in the sender/receiver populations can facilitate the prioritisation of potential communication events that distinguish groups of samples or conditions. In the hypothesis-free approach, CCC events are decomposed by higher-order dimensionality reduction methods such as Multicellular Factor Analysis (MOFA) and Tensor-cell2cell. The key features that represent the significant difference between the different conditions will be used to identify putative causal ligand-receptor pair relevant to perturbations. Furthermore, intracellular pathways downstream of ligand-receptor interaction can be modelled by integrating signed and directed protein-protein interactions as well as with transcription factors from OmniPath. By connecting the cell-cell interaction with intracellular events, the network-optimisation approach in LIANA can compressively elucidate the biological significance of microenvironment on the intra- and intercellular processes. 

LIANA can also be implemented in spatial transcriptomic data using with standard non-negative matrix factorization (NMF) to identify intercellular programmes in cross-condition database.
Genome-scale requirements for dynein-based trafficking revealed by a high-content arrayed CRISPR screen 
https://www.biorxiv.org/content/10.1101/2023.03.01.530592v1
An arrayed loss-of-function CRISPR screening was leveraged with a high-content imaging workflow, which can capture the phenotypic variations on the subcellular compartment after the perturbation and then infer a more direct genotype-phenotype relationship. In the arrayed CRISPR screening, one gene is targeted per well with four unique synthetic two-part guide RNAs (crRNAs) in Cas9-expressing cell lines. Perturbed cells are fixed and analyzed with the high-throughput imaging platform, generating a detailed phenotypic fingerprint with pathway-relevant quantitative parameters. A high-dimensional matrix of gene and imaging-based feature from multiplexed images is then available for the unsupervised phenotypic clustering to identify the co-functional genomic hits in the biological pathway of interest.  

Scalable genetic screening for regulatory circuits using compressed Perturb-seq
https://www.nature.com/articles/s41587-023-01964-9

Perturb-seq can integrate the pooled genomic screening results with transcriptomic read-outs, connecting the gene function to the diverse molecular phenotype in each cell population. However, the cost of a large-scale Perturb-seq screening can be very high, and the feasibility is often affected by the limited availability of samples to perform a systemic combinatorial genetic perturbation. Interestingly, based on the sparse nature of functional genetic network and perturbation effect in the cells, a small number of random combinatorial perturbation is enough to recover the function of each individual perturbation by sparse inference algorism. 
Compressed Perturb-seq can significantly increase its scalability by introducing composite samples, which is far fewer than the number of sample/perturbation in conventional perturbation screening. In the conventional perturbation screening, one sample per perturbation so the sample number (O(n)) is linear proportional to number of perturbations (denoted as n). But only a small number of perturbations (let’s say k) have effect on the readable phenotype or the latent factors that represents the underlying phenotypes, which means k is way fewer than n. In the compressed screening with a single-value readout (viability, normally for drug sensitivity assay), O(klog(n)) composite samples should be enough for the sparse inference algorism to recover the k perturbation with phenotypic effect. In Peturb-Seq, a high dimensional phenotype (m genes or compressed cellular state score) is generated as a n × m perturbation effect size matrix (n for perturbation number, m for each detected gene/cellular state), in which can be factorized by two matrices (n × r left factorized effect size matrix, r × m right factorized effect size matrix, r is the rank of the n × m matrix). q is denoted as the maximum number of non-zero elements in any column of the left matrix of the factorized effect size matrix (n × r). In other words, r is the number of co-functional gene regulation networks, q is the number of co-functional perturbations. Here, the number of composite samples is O((r+q)log(n)). In both cases (low/high dimensional readout perturbation screening), the number of samples should be sub-linearly with the number of perturbations.  
In this paper, two experimental strategies are established for the Compressed Perturb-seq (‘cell-pooling’ and ‘guide-pooling’). Moreover, Factorize-Recover for Perturb-seq (FR-Perturb) is developed to infer the individual perturbation effects from composite samples. 


Systematic reconstruction of molecular pathway signatures using scalable single-cell perturbation screens

https://www.biorxiv.org/content/10.1101/2024.01.29.576933v2

A modified Perturb-Seq (pooled functional genetic screening with scRNAseq) is designed for multiplexed samples from diverse biological contexts. By combinatorial Parse barcoding in SPLiT-seq, this highly scalable Perturb-Seq can integrate the transcriptomic readout from diverse biological models and experimental treatments after genomic perturbations at a relatively low cost. In this study, sgRNAs from CRISPRi library were used to perturb a few specific molecular regulators in 5 signalling pathways (interferon-beta, interferon-gamma, insulin, TNFa, TGFb) in 6 cell lines from different tissues, identifying the conserved signatures at the sub-pathway level across multiple biological contexts. This is different from Genome-Wide Perturb-seq (GWPS) with a high number of genetic perturbations on one condition/cell type, which aims to explore the novel genotype-phenotype relationship in single biology model. To recover genomic perturbation information, the sgRNA pool was cloned into a CROP-seq vector (with barcoded sgRNAs), and each sgRNA can be captured, reverse transcribed, and barcoded by poly(dT) and random hexamer primers during the library preparation of SPLiT-seq (Parse bioscience). A guide additive primer was added in cDNA amplification to enrich the CRISPR guide so that the final guide library, sharing the same Parse barcodes as the mRNA to indicate the experimental condition/cell line, would be generated for sequencing. Moreover, this method is also compatible with Ultima Genomics sequencing platform. 

Mixscale, an improved computational framework for Perturb-Seq, was untilized to perform the weighted differential expression analysis and interpret  the transcriptome-wide perturbation in individual cells. 


A cellular hierarchy framework for understanding heterogeneity and predicting drug response in acute myeloid leukemia  

https://www.nature.com/articles/s41591-022-01819-x

1.	From the reanalysis of scRNAseq data from 12 AML patients,  three distinct populations of leukemia stem and progenitor cells were defined using self-assembling manifolds (SAM). 
a.	Quiescent LSPC: low transcriptome diversity and core LSC programs
b.	Primed LSPC: CDK6 expression, E2F3 targets, inflammatory signature and myeloid lineage 
c.	Cycling LSPC: E2F targets and stem cell activation 
2.	Deconvolution of bulk AML transcriptomes using the new LSPC classification as well as four differentiated  leukemic cell types (GMP-like, ProMono-like, Mono-like and cDC-like), generating the composition of each AML cell population across different AML samples 
3.	The correlation of the abundance of quiescent LSPC with the high engraftment of LSCs in previous xenotransplantation experiment. The classification 
4.	Bulk RNAseq data from TCGA, BEAT-AML and Leucegene cohorts was clustered based on the relative cellular abundance of seven leukemic cell types. Four distinct subtypes were discovered: 
a.	Primitive (shallow hierarchy, LSPC-enriched)
b.	Mature (steep hierarchy, enriched for mature Mono-like and cDC-like blasts)
c.	GMP (dominated by GMP-like blasts) 
d.	Intermediate (balanced distribution) 
5.	Hierarchy composition is associated with AML genomics, patient prognosis, diagnosis and relapse. Ex vivo drug sensitivity data is strongly associated with the proportion of primitive/mature blasts in the samples (PC2 in the PCA). 
6.	To predict the drug selectivity from the hierarchy composition estimation of bulk RNAseq data, a seven-gene lineage classification subscore from LSC17 score was trained using LASSO regression on PC2 of previous PCA. Moreover, a different PC2-34 score was also trained using top 50 PC2-correlated and top 50 PC2-anticorrelated genes. Both scores are correlated well with primitive versus mature axis in pediatric AML and clinical response of non-chemotherapy agents. 
7.	Changes in the abundance of leukemic cell types were reanalysed in RNAseq sample before and after treatments. 




SIGNAL-seq: Multimodal Single-cell Inter- and Intra-cellular Signalling Analysis 

https://www.biorxiv.org/content/10.1101/2024.02.23.581433v1

SIGNAL-seq integrates the single-cell RNAseq (SPLiT-seq) with the post-translational modifications to directly improve the resolution of signal pathway activity in the scRNAseq, prioritising the distinct cellular state with a specific pattern of phosphoproteome and transcriptome. 

Cells are fixed, permeabilised, blocked and stained with a poly-A barcoded oligonucleotide-tagged antibodies targeting phosphorylation of intracellular and extracellular proteins. The pre-fixed/stained cells are compatible with the combinatorial barcoding of SPLiT-seq, generating parallel NGS libraries for both RNA (oligo-dT and random hexamer reverse transcription primers) and phosphorylated proteins (oligo-labelled antibody-derived tags). 

SIGNAL-Seq facilitates the identification of drug-sensitive subclone in the organoid system by measuring the phosphorylation pro-apoptotic protein as well as the dynamics of transcripts in cell cycle and protein coding. 

SIGNAL-Seq correlates the distinct patterns of intracellular protein phosphorylation with specific transcriptomic signatures inferred from functional assay or scRNAseq (e.g. chemotherapy-resistant revival state) so that a further clustering and annotation  of subpopulation may be possible. 

The phosphorylation data is informative to generate the intracellular signalling network, which interconnects the ligand-receptor interaction into a more comprehensive cell-cell communication system within a coculture model. 




Pathway level subtyping identifies a slow-cycling biological phenotype associated with poor clinical outcomes in colorectal cancer

https://www.nature.com/articles/s41588-024-01654-5

A super cool paper defines a novel pathway-derived subtype of colorectal cancers (CRCs) based on the cellular differentiation (PDS3). Different from PDS1 (proliferative, LGR5+ canonical stem cells enriched) and PDS2 (regenerative/revival/foetal-like stem cell enriched, marked with high Annexin1 expression), PDS3 is strongly associated with the high activity of polycomb repressive complex (PRC), resulting in a more differentiated state in epithelial cells from PDS3 tumours. A MYC-PRC axis can be constructed between PDS1- and PDS3-like tumours. 

An important lesson for me is that this PDS3-like tumour could be ignored in preclinical model. A good example is that the niche ligands in organoid culture media, which aim to maintain a stem cell-enriched population inside the organoid system, may reduce the differentiation potential and dissemble the PDS3 stem-differentiation patterns, emphasizing the importance of modelling PDS3 tumour biology. 


CROPseq-multi: a versatile solution for multiplexed perturbation and decoding in pooled CRISPR screens

https://www.biorxiv.org/content/10.1101/2024.03.17.585235v1

CROPseq-multi is a new lentiviral system to perform a high-efficient multiplexing perturbations with a low lentiviral recombination rate. In the original CROPseq vector, 
sgRNA sequence is encoded inside the 3' long terminal repeat (LTR), which is further duplicated to a new lentiviral 5 end copy via an intramolecular duplication process over the lentiviral integration into the host cell genome. While the 5-end copy expresses the functional sgRNA for CRISPR perturbation, the 3-end copy is transcribed with the polII-driven expression of the selection marker gene. The encoding of 3-end copy enables the embedding of sgRNA sequence in the mRNA, which can be used as the barcode for the mRNA-based detection like single-cell RNA-sequencing. In CROPseq-inspired multiplexing solution, two sgRNA sequences are multiplexed into the CROPseq-multi vector and a 12 bp "internal barcodes" (iBAR) is linked to each sgRNA within the sgRNA loop region, which allows the identification of unique sgRNA combinations. The close proximity of the iBARs to the sgRNAs also minimizes disruption from lentiviral recombination. Moreover, a tRNA sequence is inserted between two sgRNAs so that, when expressed, endogenous RNases are recruited endogenous RNases to cleave and release two sgRNAs into individual functional guides (e.g. U6-tRNA-sgRNA-tRNA-sgRNA). To make sure the selective processing of the tRNAs by the RNases from the Pol III transcript (U6-driven sgRNAs) but not the Pol II transcript (EF1a-driven selection marker mRNA), the whole cassette was encoded in reverse orientation within the 3' LTR. 

CROPseq-multi shows comparable per-guide activity to the original CROPseq system for single guides. By multiplexing guides, it enables improved on-target efficiency in single-target CRISPR screens and combinatorial screening of genetic interactions. In addition, multiplexing allows targeting multiple distinct genes simultaneously in the same cell. This enables studying genetic interactions, where phenotypes arise from the combined perturbation of multiple genes rather than individual genes alone. Lentiviral recombination rates for CROPseq-multi are low when using orthogonal tRNA sequences to separate the multiplexed guides. 

In general, CROPseq-multi provides a versatile solution for multiplexed perturbations with mRNA barcoding, which is compatible with diverse pooled CRISPR screening approaches like single-cell sequencing assays and in situ detection workflows using the popular SpCas9 enzyme.




Progressive plasticity during colorectal cancer metastasis

https://www.biorxiv.org/content/10.1101/2023.08.18.553925v1

This paper comprehensively investigates the progression of metastasis in colorectal cancers utilizing the single cell expression atlas of normal colon, primary and metastatic colorectal cancer (CRC) derived from the same patients (microsatellite stable, mismatch repair proficient (MSS/pMMR) metastatic colorectal cancer). A two-stage model of CRC metastasis is described here: a canonical LGR5+ intestine stem cell (ISC)-like/dedifferentiated state with a considerable level of lineage heterogeneity in the primary tumour; over the metastatic progression, an intermediate state, marked by a profound loss of ISC-like identity and acquisition of a foetal progenitor-like phenotype, results in a non-canonical differentiation into diverse lineages such as squamous and neuroendocrine. The enrichment of this foetal progenitor-like intermediate state with high phenotypical plasticity is strongly associated with metastasis and chemotherapy. The presence of non-canonical differentiation and foetal progenitor signatures in primary tumours is linked to worse clinical outcomes like recurrence and poor survival, highlighting their potential as prognostic biomarkers. Transcriptional factor PROX1 is identified as a key repressor that enforces intestinal lineage identity and restricts plasticity in primary tumours. Its downregulation licenses the dynamic entry into non-canonical differentiation states during metastasis.

Of note, such phenotypic plasticity can be reproducible in tumour-derived organoids. In the standard organoid culture media containing niche factors, organoid lines from the primary tumour and liver metastasis are featured with ISC-like and mixed lineage signature (ISC-like + endoderm progenitor) respectively. Intriguingly, withdrawing the niche factors in the culture media upregulates the expression of genes in non-canonical modules in the organoid line from the liver metastasis, but the organoid line from primary tumour remains restricted to the intestine axis, indicating a highly cell-autonomous lineage differentiation potential (‘lineage memory’) retained in the in vitro organoid models. 

The use of hotspot module analysis and trajectory alignment is super cool in this paper.  
Hotspot module analysis identifies context-specific modules active only in subsets of cells, which is critical for capturing the transcriptomic heterogeneity of samples across different patients. To track the patient-specific progression trajectories of canonical and non-canonical differentiation among different samples, dynamic time warping was used to align the temporal sequences while allowing different starting/end points and progression rate. In this case, the patient with the broadest spectrum of cellular states was used as a reference and, after aligning of other patients exhibiting non-canonical differentiation, a conserved progression sequence was confirmed across the samples (ntestinal stem cell state -> fetal progenitor state -> branching into squamous or neuroendocrine differentiation). 


Transcriptional signals of transformation in human cancer 
https://genomemedicine.biomedcentral.com/articles/10.1186/s13073-023-01279-z

Stem cell can proliferate indefinitely while retaining a differentiation capacity into multiple lineages, for example, from embryonic stem cells into more than 220 cell types in the adult human body. A reverse process, or dedifferentiation, has been observed over the malignant transformation, in which the adult cancer cells ewith oncogenic mutations may regain a stem cell-like state, partially resembling tissue-specific foetal or primordial embryonic cells. In this paper, to quantify the relative abundance of cancer cell at specific developmental state, a comprehensive reference atlas was compiled from the transcriptomic data of human pre-gastrulation, gastrulation, foetal tissues, and adult tissues, which is applied to the bulk transcriptomes of different cancers across various organs. A deconvolution-like method was used to estimate the percentage of transcriptomic signal explained by the provided reference to decipher the general cell state in the tumour. 

This paper makes an important distinction between an ‘embryonic state’ (primordial, pluripotent stem cell-like state, specifically the pre-gastrulation epiblast and hypoblast cells) and a ‘foetal-like state’ (an antenatal state between the embryonic state and adult tissue) to characterise the dedifferentiation pattern in the cancer transcriptomes. This foetal-like transcriptional signature is a near-universal feature in childhood cancers, likely reflecting the developmental origins. However, the reversion of adult cancer cells into foetal-like state is highly dependent on the cancer type, such as hepatocellular carcinoma (HCC). Authors found that the transcriptomes of some HCCs were best explained by foetal hepatoblastoma cells rather than adult hepatocytes, suggesting an evident foetal reprogramming in a proportion of HCC patients. In contrast, colorectal cancers did not show an obvious transcriptional shift to a foetal-like or embryonic state, but rather resembled an aberrant adult colorectal stem cell population transcriptionally. 


A heterogeneous pharmaco-transcriptomic landscape induced by targeting a single oncogenic kinase
https://www.biorxiv.org/content/10.1101/2024.04.08.587960v2
Polypharmacology is referred to the ability of single drug compound to interact with multiple proteins or biological pathways different from its intended target, which may result in a distinct transcriptomic program secondary to its primary pharmacological mechanism. In this paper, a single-cell chemical transcriptomic profiling of glioblastoma (GBM) patient-derived cell lines (PDCLs) was performed to systematically characterise the transcriptomic landscape, or polypharmacology, induced by a large panel of EGFR inhibitors. A modified multiplex scRNAseq workflow was utilized here to combine combinatorial indexing with oligonucleotide-based barcoding to enable isoform resolution while combining multiple drug-exposed samples. Two screens were included: a pilot screen via sci-Plex approach, 6 EGFR inhibitors with 7 doses on 4 GBM models, 188,746 transcriptomes across 172 conditions; a larger screen via this modified workflow, 72 inhibitors with 4 doses on 3 patient-derived models, 128,868 transcriptomes across 1800 conditions. 
To capture the shared or drug-specific transcriptomic pattern, a standard differentiation expression analysis was performed to identify the dose-dependent differentiated-expressed genes, which were then grouped into co-expressed modules that were upregulated or downregulated by specific inhibitors or shared across multiple inhibitors independently for each model. 
In the large EGFR inhibitor screen, a deep generative framework (MRVI) was used to comprehensively stratify the inhibitors based on the transcriptomic signature. MrVI learns two distinct latent spaces (sample-unaware "U-space" and sample-aware “Z-space”) to account for batch effects while stratifying the drug responses. For each GBM model, a MrVI model was trained to define a unique drug-dose combination as the "sample-of-origin”, and a pairwise sample-sample distance was calculated to group drug-dose combinations that resulted in similar transcriptional responses into "Response Modules" (RMs) for each model. The authors then performed covariate-specific differential expression to identify RM-specific expression signatures and cluster RMs across models based on similarities in these signatures, thereby defining the clustered RM groupings as "Transcriptional Drug Classes" (TDCs) of EGFR inhibitors that induce coherent molecular programs.

In-depth immunometabolic profiling by measuring cellular protein translation inhibition via bioorthogonal noncanonical amino acid tagging (CENCAT)

https://www.biorxiv.org/content/10.1101/2023.08.03.551800v2 

CENCAT (cellular protein translation inhibition via bioorthogonal noncanonical amino acid tagging) is designed to probe the functional metabolism of complex samples at single-cell resolution. By using inhibitors of two major metabolic pathways (glycolysis and oxidative phosphorylation), CENCAT measures the protein synthesis rate under the energy starvation and estimates the proportional reliance of the cells on glycolysis over oxidative phosphorylation for deriving energy and supporting the protein synthesis. Different from SCENITH (Single Cell Energetic metabolism by profiling Translation inhibition) using cytotoxic puromycin, CENCAT employs click chemistry to fluorescently label the newly synthesised proteins containing incorporated non-canonical amino acids like L-homopropargylglycine (HPG) and β-ethynylserine (βES, which shows higher incorporation efficiency than homopropargylglycine), providing a more accurate measurement of protein synthesis rate. 

It may be worth to mention the sample preparation in CENCAT. After the treatment of metabolic inhibitors, HPG and βES was then added to label newly synthesized proteins, followed by mild fixation and permeabilization conditions. Cells from different metabolic starvations were ‘barcoded’ with amine-reactive dyes (4 unique barcoding patterns for 4 treatment conditions) and pooled together for antibody staining. In this paper, CENCAT combined with 9-12 antibody panel and could be compatible with a more complex antibody panel (more than 20 antibodies), which enables the incorporation of a high-dimensional immunophenotyping into the functional metabolic profiling. The key requirement is to reserve at least one channel for the click labelling of the incorporated HPG or βES (e.g. AF488 or AF405 azides). 

I wonder if the workflow of CITE-Seq may be potentially compatible with CENCAT, which can provide a multi-omics view. 



Systematic dissection of tumour-normal single-cell ecosystems across a thousand tumours of 30 cancer types

https://www.nature.com/articles/s41467-024-48310-4
The specific fibroblast subpopulation in. 



A developmental constraint model of cancer cell states and tumor heterogeneity

https://www.cell.com/cell/abstract/S0092-8674(24)00458-6?rss=yes

Three features of cancer cell dynamics in developmental constraint model: 
Recurrence: The same set of gene module/transcriptomic programme tend to recur and manifest across the different type of cancers (e.g. mesenchymal state), suggesting the repertoire of possible cell state in cancer is limited and recurrent. 
Co-option of programs: The gene module/transcriptomic programme underpinning the observed cell state/phenotype are not often novel or cancer-specific but appears to be co-opted from normal development. For example, general biological 
Plasticity: Cancer cells can transition dynamically between these distinct cell states (forwards to differentiated state, backwards to stem-like state, or accessible state from the developmental trajectory of their origin). The highly plasticity cancer cell can give rise to phenotypically divergent states and reconstitute the whole heterogeneity of the tumour. 

The general pattern in cancer cell state: 
The overall repertoire of cell states (comprising the intra-tumoral heterogeneity) accessible to the cancer cell of a given cancer is highly constrained by the developmental lineage map of its particular cell-of-origin. 

Four distinctions of the developmental constraint model from other existed models: 

Non-hierarchical organization of cancer cell states
bi-directional differentiation (both differentiated or dedifferentiated) 
Constraints on the transitions between states based on developmental lineages
No privileged state, but context-dependent transitions driven by plasticity

Multicellular factor analysis of single-cell data for a tissue-centric understanding of disease

https://elifesciences.org/articles/93161
Multicellular factor analysis (MOFAcellular) is an unsupervised computational framework to identify the shared/cell type-specific transcriptomic programme across diverse cell populations from single-cell atlases containing multiple samples and conditions. MOFAcellular repurposes group factor analysis, Multi-Omics Factor Analysis (MOFA), to decompose the high-dimensional single-cell expression profile into a low-dimensional representation (a more interpretable latent space) that captures the key sources of variability across samples and cell types. Firstly, single-cell expression profile is organised into a multi-view dataset, in which cell-type views are the summarized expression profile of high variable genes in each cell type per patient (or tissue-centric views such as cell compositions, spatial relationships). MOFA model is fitted into multi-view dataset to obtain specified number of factors representing the coordinated molecular changes across cell types. While factor scores represent the coordination of samples with factor in the latent space, factor loadings (weights) stand for how significant each gene contributes to the factor in each cell type/view. This latent space, consisting of specific factors, captures both shared variability across cell types and cell-type specific variability associated with biological or technical covariates, which are very helpful to joint analysis of multiple patient cohorts and integration across different data modalities.


Stem-cell states converge in multistage cutaneous squamous cell carcinoma development

https://www.science.org/doi/10.1126/science.adi7453
This paper presents a comprehensive study of stem cell dynamics and cellular plasticity during the transitions from normal skin through preneoplasia to malignant carcinomas in mice model. From transcriptomic profiling, two distinct states of stem cell population were characterised: "upper spike" cells characterized by rapid proliferation, self-renewal, and genomic instability; "lower spike" cells featured with quiescence, lineage plasticity, and stress responses. Cells can move between two states over the cancer development and the papilloma stage is a critical transition point where cells can adopt either the upper spike or lower spike state. 


An atlas of epithelial cell states and plasticity in lung adenocarcinoma

https://www.nature.com/articles/s41586-024-07113-9

A comprehensive single-cell analysis of early-stage lung adenocarcinoma (LUAD) and surrounding normal lung tissue in both human samples and mouse models. A new intermediate state of alveolar cells, known as KRT8+ alveolar intermediate cells (KACs), was identified with reduced differentiation and increased plasticity. KACs, highly enriched in tumor-adjacent normal regions, were found to harbour KRAS mutations and display transcriptional features like KRAS-mutant tumour cells, suggesting they may be precursors to KRAS-mutant LUADs. Lineage tracing experiments in mice model showed that KACs can arise from alveolar type 2 (AT2) cells and may be intermediates in the transformation of AT2 cells to tumour cells. Interestingly, KACs are sensitive to KRAS inhibition. 


Cellular adaptation to cancer therapy along a resistance continuum

https://www.nature.com/articles/s41586-024-07690-9


This study systemically investigates the progressive model of drug tolerance development along a "resistance continuum" through a series of in vitro (primarily on Kuramochi, BRCA2-deficient high-grade serous ovarian cancer cell line, treated with PARP inhibitor Olaparib; the validation of findings across multiple other cancer types such as melanoma and lung adenocarcinoma models) and in vivo patient-derived xenograft models. Here, two modes of drug tolerance were highlighted across different experimental designs: a persistent state with a low level of resistance, represented by the surviving drug-naïve cancer cells after an acute high-dose challenge; a full-adapted state with a high level of resistance, represented by proliferating cells after a longitudinal dose escalation (which generated a panel of 9 adapted cell populations over 10 months, and the most resistant population could reach confluency at 320 μM olaparib). A reversible persistent phenotype emerges at an early stage in the resistance continuum, followed by multiple cell state transitions into a stable adaptation of cancer cell line resistant to olaparib. Along the resistance continuum, the stepwise assembly of transcriptomic and epigenetic reprogramming as well as copy number alterations marks the complete acquisition of high phenotypic plasticity, manifested by epithelial-to-mesenchymal transition, plastic lineage identity (dedifferentiation to stem-like state), metabolic rewiring and stress programmes activation, which cooperatively contributes to the drug resistance. Of note, epithelial-to-mesenchymal transition-related changes occurred early in the adaptation process but didn't continue to increase in later stages, despite increasing resistance. A gradual dedifferentiation, featured with the loss of lineage markers and acquisition of stem-like features, were observed across multiple stages of resistance continuum, suggesting lineage plasticity is not as an all-or-nothing phenomenon. However, epithelial-to-mesenchymal transition and lineage plasticity are not the end goal of resistance, but rather mechanisms that allow cells to explore a wider range of phenotypic states. This increased plasticity enables cells to activate additional adaptive programs (like stress responses and metabolic rewiring) that ultimately confer higher levels of drug resistance. 

Non-genetic mechanisms of therapeutic resistance in cancer  

https://www.nature.com/articles/s41568-020-00302-4

In general, drug resistance results from genetic (both pre-existing and acquired mutations) and non-genetic mechanism. Two transcriptomic mechanisms are introduced here: transcriptomic priming, in which a subgroup of drug-resistance cells (primed state) is pre-existed before the treatment and highly enriched after the treatment due to its inheritable fitness advantage (in other words, a passive Darwinian selection); transcriptomic adaptation, in which an active adaptation on high plastic cells contributes to the rewiring of intracellular programmes and appearance of drug-resilient population (an active Lamarckian induction on the level of epigenetic reprogramming). Non-genetic resistance can be transient/reversible/intermediate, as drug-tolerant persister, and inheritable/stable/full-adapted, as "phoenix" cells embodying both transcriptomic priming and adaptation. They may be primed to survive the initial challenge and be capable of maintaining the resistance and accumulating the fitness advantages throughout the treatment. Cancer cells at phoenix states seem to have a stem-like cell features with a high transcriptomic plasticity and lineage infidelity (such as trans-differentiation under the pressure). 

Cancer cell states: Lessons from ten years of single-cell RNA-sequencing of human tumours
https://www.cell.com/cancer-cell/fulltext/S1535-6108%2824%2900304-0

While inter-tumour heterogeneity predominantly reflects the tumour-specific pattern of development and progression in each patient or different anatomical sites of the same patient, intra-tumour heterogeneity refers to distinct biological phenotypes on the single-cell or sub-population level within a tumour. With the help of scRNAseq, the discrepant gene expression pattern inside a tumour, defined as expression intra-tumour heterogeneity (eITH), indicates different cell states (e.g. cell cycle or stress programme), developmental stages (e.g. transdifferentiation or dedifferentiation along the lineage trajectory), functional phenotypes (e.g. sensitive or resistant to therapy) and microenvironment niches (e.g. immune infiltration or stromal compartment), which can be recurrently observed as commonly-shared transcriptomic programmes independent of specific cancer type. eITH can be seen as a snapshot, or an observable outcome, of tumour plasticity at a given moment. The diverse cell states observed in eITH often represent different phenotypes that cells can adopt through plasticity.

Three approaches to unravel the intra-tumour heterogeneity:
Clustering: detect distinct cell states but not continuum of states
Pseudotime analysis: good at dissecting continuous stages of linear progression on single direction but have difficulty in modelling multi-directional transitions. 
Transcriptomic programme scoring: provides a more nuanced view of cell states and characterizes cells based on the activation of multiple gene programs; challenging in annotating/interpreting the biological insights of programmes 
 

A classical epithelial state drives acute resistance to KRAS inhibition in pancreas cancer

https://aacrjournals.org/cancerdiscovery/article-abstract/doi/10.1158/2159-8290.CD-24-0740/746288/A-classical-epithelial-state-drives-acute?redirectedFrom=fulltext

This paper focuses on the development of drug resistance towards KRAS inhibitors in pancreatic ductal adenocarcinoma (PDAC). In genetically engineered mouse models and patient-derived xenografts, three cancer cell states, defined as the distinct phenotypic and functional characteristics that malignant cells can adapt, sometimes reversibly, inside a tumour, were discussed: 1) classical state with an epithelial-like and more differentiated feature, displaying an acute resistant to KRAS inhibition (MRTX1133) but more sensitive to chemotherapies; 2) basal/quasi-mesenchymal state with an invasive morphology, chemo-resistant but sensitive to KRAS inhibitors;  3) a mesenchymal state with fibroblast-like morphology, normally associated with invasive behaviour and metastasis. Upon the treatment of KRAS inhibitors, cancer cells can shift along this classical-basal axis and classic cells can serve as reservoir for tumour regrowth after short-term KRAS inhibition. To prove it, the authors developed a genetic system where they could permanently label classical (Lgals4+) cells at a specific time point and then follow their progeny, demonstrating that the descendants of classic cells survived the KRAS inhibition and gave rise to basal and mesenchymal cells in the relapsed tumours. 

Mechanisms of resistance to oncogenic KRAS inhibition in pancreatic cancer 
https://aacrjournals.org/cancerdiscovery/article/doi/10.1158/2159-8290.CD-24-0177/746286/Mechanisms-of-resistance-to-oncogenic-KRAS
Acquired resistance to KRAS inhibition in PDAC was investigated using multiple in vitro and in vivo models. Both genetic and transcriptomic mechanism contribute to the increased resistance to MRTX1133. On the level of transcriptomics, epithelial-to-mesenchymal transition (EMT) and PI3K-AKT-mTOR signalling were associated with resistance. Single-nucleus RNA sequencing of KPC mouse tumours identified 51 high-quality programs using non-negative matrix factorization (NMF), including key metaprograms such as a) Classical (epithelial) state b) Mesenchymal state c) partial-EMT (pEMT) state. To understand the evolution of cell state across the MRTX1133 treatment, a Markov absorption-based classification approach was used to classify cells into classical, mesenchymal, and pEMT states. Interestingly, malignant cells at mesenchymal state were more sensitive to KRAS inhibition than those at classic state initially (at day 3 of MRTX1133 treatment), while the cells at pEMT state was associated with resistance acquisition in the MRTX1133, supporting that the intermediate state in the classic EMT framework is likely to be the most plastic population responsible for the transcriptomic adaptation under a long-term KRAS inhibition in KPC mouse models. 


Cancer drug-tolerant persister cells: from biological questions to clinical opportunities
https://www.nature.com/articles/s41568-024-00737-z
Drug tolerant persisters (DTPs) can arise from preexisting population (Darwinian selection) or emerge over the self-adaption of drug challenges (Lamarckian induction). 
Resistance: genetically inheritable insensitivity towards therapy; proliferate under treatment; stable drug tolerant state 
Persistence: not necessarily acquire genetic mutations; temporary and reversible state of drug tolerant state; viable but not proliferative in presence of drugs; proliferate and give rise to sensitive cells once drug is removed; mainly present in subcolonal population as DTPs. 
Mechanism of DTPs: epigenetic rewiring; transcriptional adaptation; translational rewiring/selective translation; metabolic rewiring/redundancy. 
Phenotypic plasticity: low lineage commitment (transition into multiple states); flexible switch between cycle and non-cycle state; stem/progenitor-like state with a high differentiation capacity; diapause-like state as an embryonic survival phenotype
Microenvironment: immune evasion under immunotherapy; stromal compartment (Tumour-associated macrophages and cancer-associated fibroblasts)
Innovative technologies: single-cell lineage tracing and sequencing; single-cell multiomics; imaging and spatial technologies on tumour microenvironment; cell-state reporter
Targeting Cancer Cell-Intrinsic Vulnerabilities (metabolic dependence or ferroptosis sensitivity); Targeting Adaptation Mechanisms (Epigenetic Targets or DNA Damage Response); Targeting Tumour Microenvironment Interactions


Microenvironment drives cell state, plasticity, and drug response in pancreatic cancer
https://www.cell.com/cell/fulltext/S0092-8674(21)01332-5?_returnURL=https%3A%2F%2Flinkinghub.elsevier.com%2Fretrieve%2Fpii%2FS0092867421013325%3Fshowall%3Dtrue
The authors developed a pipeline to generate the matched single-cell transcriptomic profile from pancreatic ductal adenocarcinoma (PDAC) patient biopsies and organoid models derived from the same core needle biopsy. Thus, the direct comparison between the in vivo tumour state and organoid model state is possible. This study found that organoid models generally retained genetic alteration present in the primary tumour, suggesting that organoid model is a faithful genetic representations of patient tumour. However, there is a significant discrepancy between transcriptional state between primary tumour and matched organoid model (organoids showed a strong bias to classical-like state and exhibit a strong culture-specific gene expression pattern). By modifying the culture condition and re-introducing tumour microenvironmental cues (e.g., using minimal media or adding specific factors like TGF-β), the heterogeneity of transcriptional states can be partially restored, and the organoid lines can regain the access to the full spectrum of cell state observed in the primary tumour. 

FlowSig
https://www.nature.com/articles/s41592-024-02380-w
FlowSig aims to trace the information flows between cells, infer the causal relationships between signals and gene modules and construct a more comprehensive cell-cell communication network than conventional communication representation method. Using scRNAseq or spatial transcriptomics data, FlowSig integrates three parts of cell-cell communication: inflowing signal (receptor level); intracellular processing (gene expression modules); outflowing signal (ligand downstream of transcription factor network). The ligand-receptor pairs are identified by CellChat (non-spatial data) and COMMOT (spatial data), followed by the construction of gene expression modules (pyLIGER for non-spatial data; Non-negative Spatial Factorization for spatial data; both decompose the expression matrix into factors and loadings). To infer the potential relationship between different informative variables (inflowing/outflowing signals and gene modules), graphical causal modelling is used to generate a directed graph (Completed Partially Directed Acyclic Graph, CPDAG) with biological constraints (e.g. inflow -> GEM -> outflow, unidirectional; GEM <-> GEM, bidirectional). Conditional independence tests are used to eliminate unlikely direct relationships in the graph. For non-spatial data, FlowSig also leverages perturbation information (e.g., disease vs. healthy states) to refine its inferences, using conditional invariance testing.
Nicheformer
Nicheformer is a transformer-based foundation model for spatial transcriptomics. To gain a more comprehensive representation of cell states, this model has been pretrained on dissociated and image-based spatially resolved single cell data (SpatialCorpus-110M, 110 million cells from 73 different tissues including 17 solid organs and 18 cell lines: 57 million cells from dissociated dataset; 53.8 million cells from spatially resolved cells). Beyond the gene expression information, Nicheformer incorporates the contextual information such as organism, modality and sequencing technologies (e.g., 10x Genomics, MERFISH, CosMx) into the model training, aiming to cover cross-tissue, cross-technology and cross-disease variations. 
For each cell, genes are ranked on the relative gene expression after the technology specific normalization, which accounts for the technical variation, and converted into tokens (Vocabulary of 20,310 tokens). A comprehensive token sequence is generated incorporating gene tokens and contextual tokens (assay, organism, modality) that capture the biological and experimental information. The transformer architecture, comprising 12 blocks with 16 attention heads each, processes the token sequences (max 1500 tokens) and learns the gene-gene relationship through self-attention mechanisms. Aggregating the gene tokens from the transformer's last layer, the final 512-dimensional embedding (with 1024-dimensional feed-forward networks) is generated to represent cell states in a unified space that accounts for local dependencies in the cellular microenvironment and underlying cell interactions across multiple tissues of two species.
Nicheformer can predict the missing spatial features for dissociated cells without spatial information, such as 1) possible cell types based on spatial context; 2) probable niche or region labels; 3) estimated neighbourhood composition or density. It can be done by either linear probing, where the simple linear model can be added and trained on the top of the frozen embedding from the main model ("zero-shot-like" performance); or fine-tuning, where the pretrained nicheformer model can be updated with new parameters for the specific task. 
Interestingly, Nicheformer does not directly use physical spatial coordinates during model pretraining but learns the gene expression pattern with spatial localisation to infer the spatial information from dissociated samples. This model leverages the biological principle: the spatial context may be inherently encoded inside unique transcriptomic profiles, which are manifested by niche/tissue-specific expression programme as well as cell-environmental interactions that affects the gene expression. 

Prophet 
https://www.biorxiv.org/content/10.1101/2024.08.12.607533v2.full
Prophet is a transformer-based foundation model to enable the universal prediction of the experimental perturbations. It aims to generalise and transfer the knowledge learned from the available experiment data to estimate the possible phenotypes (e.g. cell viability, drug effectiveness, cell morphology, gene expression and cell type compositions) under the untested conditions (e.g. new chemical treatment or gene perturbations) to reduce the number of physical experiments needed and identify the active candidates. To process the input data, the information of available experiment data (4.7 million experiments) is decomposed into a three-dimensional space: cell state (bulk RNA expression profile), experimental treatment (CRIPSR and chemical treatments) and measured outcome (or phenotypes after perturbation). The representation of cell state uses the bulk RNA sequencing data of 1406 cell lines from CCLE, which are further compressed into 300 dimensions using PCA. Treatment representation vectors for chemical compounds are generated through the chemical structure (RDKit2D fingerprints, 200 dimensions; Morgan fingerprints, 1024 dimensions). For CRISPR treatments, gene co-expression pattern (from bulk RNAseq) and gene coding sequence information (from Enformer embeddings) are integrated to CRISPR embeddings, which can capture the functional and sequence-based gene characteristics. Unlike cell state and treatment representations which use prior knowledge, phenotype embeddings are developed through end-to-end learning (using one-hot encoding transformed through linear layers). These embeddings (initial embedding) are then processed through the deep learning architecture: tokenizer networks project all embeddings into a common token space, with a learnable CLS (Classification) token is prepended to each token sequence (token sequence generation). This unified representation is then processed through 8 transformer encoder units and a feed-forward network to generate 512-dimensional experiment embeddings (final embedding from the final CLS token), which can be used for the downstream phenotype prediction. 
Prophet primarily focuses on the end-to-end prediction but can also provide mechanistic insights through the construction and analysis of activity-based fingerprints, in which the compound activity can be represented by the predicted IC50 values across cell lines (forming a high-dimensional fingerprint). Distinct clusters of compounds can be identified based on the targeted pathway (e.g., MAPK, EGFR, PI3K/AKT, and mTOR pathways), and the mechanism of novel compound can be inferred based on their localisation within different drug clusters. For example, Prophet identified clusters containing known treatments for BRAF V600E melanoma and revealed additional compounds that may share similar activity patterns. 

Wnt-deficient and hypoxic environment orchestrates squamous reprogramming of human pancreatic ductal adenocarcinoma
https://www.nature.com/articles/s41556-024-01498-5
This paper focuses on pancreatic adenosquamous carcinoma (PASC), a rare histologic type of pancreatic carcinoma carrying more than 30% squamous cell carcinoma component along with co-existing adenocarcinoma component, which is found in up to 10% of pancreatic ductal adenocarcinoma cases and is featured with chemoresistance. To systemically investigate the molecular features and evolution of pancreatic cancer, 65 patient-derived pancreatic cancer organoid lines, including 6 PASC lines, were established as a comprehensive organoid biobank. Based on the morphology, three distinct groups are described: 1) Wnt-dependent cystic organoid with a clear lumen; 2) intermediate cribriform organoids; 3) Wnt-independent solid organoids with packed stratified appearance, which is strongly associated with squamous transformation and terminal state of pancreatic carcinoma. Environmental factors such as Wnt deficiency and hypoxia can induce the squamous transformation of cystic organoids into the solid organoids with an irreversible epigenetic reprogramming and H3K27-mediated suppression of ductal lineage genes. Meanwhile, TP63, as the master regulator of squamous identity, is sufficient to induce and necessary to maintain PASC phenotype, controlling the molecular reprogramming and morphological change during the squamous transformation. This study suggests that targeting the epigenetical regulator such as  EZH2 may provide clinical benefits to PASC patients. The flow is logical, moving from: organoid morphology -> functional phenotype/molecular profiling  -> mechanism discovered -> possible therapeutic intervention (EZH2 inhibition). 
DrVI 
https://www.biorxiv.org/content/10.1101/2024.11.06.622266v1
Disentangled Representation Variational Inference (DrVI) is an unsupervised deep learning generative model that creates non-linear disentangled latent representations. It performs well in separating overlapping biological processes, or "entangled" biology (such as cell type, cell cycle, stress programme and developmental programme), into different high-interpretable latent dimensions represented by key marker genes. In the pancreatic development dataset, different developmental differentiation trajectories were captured from various latent dimensions while separating the cell cycle state. In HLCA core dataset, beyond basic cell type, DrVI identifies dimensions relevant with stress response, inflammatory process and functional state/programme inside same cell identify. Regarding batch effect handling, DrVI can remove technical variations while preserving biology. 
During the training of DRVI model, a latent encoder, implemented as a multi-layer perceptron (MLP), is employed to convert the high-dimensional gene expression (as well as optional covariates like batch information) into a compressed and meaningful representation by producing the parameters (mean and variance) of a Gaussian distribution. The latent space vector z with k dimensions is then sampled from this distribution using the reparameterization trick to enable gradient-based training. For each latent dimension, a corresponding basis function f(k), acting as an individual decoder that can share parameters with other decoders, processes its latent dimension along with covariates to capture information about the identified gene programs. The outputs from each decoder are then combined using Log-Sum-Exp (LSE) pooling, which enforces additivity in count space and helps achieve theoretical guarantees for disentanglement. The entire model is trained using the Evidence Lower Bound (ELBO) objective, which balances reconstruction accuracy with the requirement that the latent space follows a standard normal distribution.


Conceptual model for holistic cell states and state transitions 
https://www.cell.com/cell/fulltext/S0092-8674(24)00461-6
Cell state emphasizes the transient or reversible alterations on the phenotypes of the cells without switching the original cell type, and the dynamic transition of cell state can be represented by a high dimensional space of quantitative measurement on phenotype such as single-cell transcriptomic profile or high-content cellular imaging. The molecular profile of cell state can be integrated by four categories of measurable observables: 1) Molecular Census (muti-omics readout), 2) Cell Organization (from imaging morphology), 3) Cell Function (a quantitative output of cell-specific behaviour or function, e.g. proliferation, differentiative capacity or motility) and 4) Extrinsic Environment (cell-cell contact, mechanic force and niche factors). 
This highly aligned configuration of four observables, visualised as a fluctuating spring-connected tetrahedron, give rise to the relative stable nature of cell state, where four vertices tend to restore the stable holistic cell state under moderate perturbations, analogous to an attractor state within dynamical systems. However, an imposed change on one vertex can be sufficient to cause the coordinated alterations on the other (either push or pull), mutually reinforcing a new cell state instead of maintaining previous stable configuration. A holistic cell state manifold is the collection of all achievable states for the cells, and a cell, represented as a dot, move along the manifold path to reach a local minimum in the motivational energy landscape. Cells reaching the same apparent states through different paths may exhibit different responses to future perturbations, known as memory effect. 
Challenges: standardization of measurements across different categories/data integration/mathematical modelling/the interactions between observables are inherently non-linear
